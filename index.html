<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRUD API - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Arial', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { text-align: center; color: white; margin-bottom: 30px; animation: fadeInDown 1s; }
        .header h1 { font-size: 3em; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.3); }
        .controls { display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; animation: slideInLeft 1s; }
        .btn { padding: 12px 24px; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .btn-primary { background: #4CAF50; color: white; }
        .btn-info { background: #2196F3; color: white; }
        .btn-warning { background: #FF9800; color: white; }
        .btn-danger { background: #f44336; color: white; }
        .users-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; animation: fadeInUp 1s; }
        .user-card { background: white; border-radius: 15px; padding: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); transition: all 0.3s; }
        .user-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,0.2); }
        .user-name { font-size: 1.5em; color: #333; margin-bottom: 10px; }
        .user-info { color: #666; margin-bottom: 5px; }
        .user-actions { margin-top: 15px; display: flex; gap: 10px; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { background: white; margin: 5% auto; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; animation: zoomIn 0.3s; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; }
        .form-group input { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; transition: border-color 0.3s; }
        .form-group input:focus { border-color: #4CAF50; outline: none; }
        .loading { text-align: center; color: white; font-size: 1.2em; }
        .pulse { animation: pulse 2s infinite; }
        
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes slideInLeft { from { opacity: 0; transform: translateX(-30px); } to { opacity: 1; transform: translateX(0); } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes zoomIn { from { transform: scale(0.3); } to { transform: scale(1); } }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ CRUD API</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π</p>
        </div>
        
        <div class="controls">
            <button class="btn btn-primary" onclick="loadUsers()">üìã –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</button>
            <button class="btn btn-info" onclick="showAddModal()">‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
            <button class="btn btn-warning" onclick="showSearchModal()">üîç –ü–æ–∏—Å–∫</button>
            <button class="btn btn-info" onclick="loadStats()">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
        </div>
        
        <div id="stats-container" style="display: none; background: white; border-radius: 15px; padding: 20px; margin-bottom: 20px; animation: fadeInUp 1s;">
            <h3 style="margin-bottom: 15px; color: #333;">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h3>
            <div id="stats-content" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;"></div>
        </div>
        
        <div id="loading" class="loading" style="display: none;">
            <div class="pulse">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div>
        </div>
        
        <div id="users-container" class="users-grid"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <h2>‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <div class="form-group">
                <label>–ò–º—è:</label>
                <input type="text" id="addName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
            </div>
            <div class="form-group">
                <label>–í–æ–∑—Ä–∞—Å—Ç:</label>
                <input type="number" id="addAge" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç">
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="addEmail" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
            </div>
            <button class="btn btn-primary" onclick="addUser()">–î–æ–±–∞–≤–∏—Ç—å</button>
            <button class="btn btn-danger" onclick="closeModal('addModal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø–æ–∏—Å–∫–∞ -->
    <div id="searchModal" class="modal">
        <div class="modal-content">
            <h2>üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <div class="form-group">
                <label>–ò–º—è –¥–ª—è –ø–æ–∏—Å–∫–∞:</label>
                <input type="text" id="searchName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
            </div>
            <button class="btn btn-info" onclick="searchUser()">–ù–∞–π—Ç–∏</button>
            <button class="btn btn-danger" onclick="closeModal('searchModal')">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>

    <script>
        async function loadUsers() {
            showLoading();
            try {
                const response = await fetch('/users');
                const users = await response.json();
                displayUsers(users);
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + error.message);
            }
            hideLoading();
        }

        function displayUsers(users) {
            const container = document.getElementById('users-container');
            container.innerHTML = '';
            
            users.forEach(user => {
                const card = document.createElement('div');
                card.className = 'user-card';
                card.innerHTML = `
                    <div class="user-name">üë§ ${user.–∏–º—è}</div>
                    <div class="user-info">üéÇ –í–æ–∑—Ä–∞—Å—Ç: ${user.–≤–æ–∑—Ä–∞—Å—Ç}</div>
                    <div class="user-info">üìß Email: ${user.email}</div>
                    <div class="user-actions">
                        <button class="btn btn-danger" onclick="deleteUser(${user.id})">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        async function addUser() {
            const name = document.getElementById('addName').value;
            const age = parseInt(document.getElementById('addAge').value);
            const email = document.getElementById('addEmail').value;
            
            if (!name || !age || !email) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }

            try {
                const response = await fetch('/users', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ –∏–º—è: name, –≤–æ–∑—Ä–∞—Å—Ç: age, email: email })
                });
                
                if (response.ok) {
                    closeModal('addModal');
                    loadUsers();
                    clearForm();
                } else {
                    const error = await response.json();
                    alert('–û—à–∏–±–∫–∞: ' + error.error);
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞: ' + error.message);
            }
        }

        async function deleteUser(id) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?')) return;
            
            try {
                await fetch(`/users/${id}`, { method: 'DELETE' });
                loadUsers();
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è: ' + error.message);
            }
        }

        async function searchUser() {
            const name = document.getElementById('searchName').value;
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è –¥–ª—è –ø–æ–∏—Å–∫–∞!');
                return;
            }

            try {
                const response = await fetch(`/users/search/${name}`);
                const user = await response.json();
                
                if (user.error) {
                    alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                } else {
                    displayUsers([user]);
                    closeModal('searchModal');
                }
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞: ' + error.message);
            }
        }

        async function loadStats() {
            try {
                const response = await fetch('/stats');
                const stats = await response.json();
                displayStats(stats);
            } catch (error) {
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: ' + error.message);
            }
        }

        function displayStats(stats) {
            const container = document.getElementById('stats-container');
            const content = document.getElementById('stats-content');
            
            content.innerHTML = `
                <div style="background: #4CAF50; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold;">${stats.–≤—Å–µ–≥–æ_–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π}</div>
                    <div>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                </div>
                <div style="background: #2196F3; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold;">${stats.—Å—Ä–µ–¥–Ω–∏–π_–≤–æ–∑—Ä–∞—Å—Ç}</div>
                    <div>–°—Ä–µ–¥–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç</div>
                </div>
                <div style="background: #FF9800; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold;">${stats.—Å–∞–º—ã–π_–º–æ–ª–æ–¥–æ–π}</div>
                    <div>–°–∞–º—ã–π –º–æ–ª–æ–¥–æ–π</div>
                </div>
                <div style="background: #9C27B0; color: white; padding: 15px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 2em; font-weight: bold;">${stats.—Å–∞–º—ã–π_—Å—Ç–∞—Ä—à–∏–π}</div>
                    <div>–°–∞–º—ã–π —Å—Ç–∞—Ä—à–∏–π</div>
                </div>
            `;
            
            container.style.display = 'block';
        }

        function showAddModal() { document.getElementById('addModal').style.display = 'block'; }
        function showSearchModal() { document.getElementById('searchModal').style.display = 'block'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function showLoading() { document.getElementById('loading').style.display = 'block'; }
        function hideLoading() { document.getElementById('loading').style.display = 'none'; }
        function clearForm() {
            document.getElementById('addName').value = '';
            document.getElementById('addAge').value = '';
            document.getElementById('addEmail').value = '';
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
        loadUsers();
    </script>
</body>
</html>